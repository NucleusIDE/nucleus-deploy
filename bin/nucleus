#!/usr/bin/env node

var cli = require("commander"),
    path = require("path"),
    args = process.argv.filter(function(a) {return !!a;}),
    fs = require("fs"),
    path = require("path");

var actions = ['init', 'setup', 'deploy', 'run'];

cli
  .version('0.0.1')
  .option("init", "Initialize nucleus config file")
  .option('setup', "Setup server for nucleus (installs node and meteor)")
  .option('deploy', "Deploy nucleus containing app to server")
  .option('run', "Run Nucleus app locally")
  .parse(args);

if(! (cli.init || cli.setup || cli.deploy || cli.run)){
  cli.help();
}

if (cli.init) {
  (function() {
    var destNucJson = path.resolve('nucleus.json');

    if(fs.existsSync(destNucJson)) {
      console.error('A Project Already Exists'.bold.red);
      process.exit(1);
    }

    var sampleNucJson = path.resolve(__dirname, '../sample/nucleus.json');

    copyFile(sampleNucJson, destNucJson);

    console.log('Empty Project Initialized!'.bold.green);

    function copyFile(src, dest) {
      var content = fs.readFileSync(src, 'utf8');
      fs.writeFileSync(dest, content);
    }
  })();
}
